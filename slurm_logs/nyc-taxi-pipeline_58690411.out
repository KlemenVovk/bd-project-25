TASK 2: Data Cleaning
Running data cleaning for yellow taxi trip data...
Found 461 parquet files in data/T1/yellow_tripdata
Computing stats...
Saving cleaned data...
Running data cleaning for green taxi trip data...
Found 286 parquet files in data/T1/green_tripdata
Computing stats...
Saving cleaned data...
Running data cleaning for fhv trip data...
Found 125 parquet files in data/T1/fhv_tripdata
Computing stats...
Saving cleaned data...
Running data cleaning for fhvhv trip data...
Found 120 parquet files in data/T1/fhvhv_tripdata
Computing stats...
Saving cleaned data...
TASK 3: File format analysis
Benchmarking file formats...
Saved CSV: results/file_format_analysis.csv
Saved LaTeX table: results/file_format_analysis.tex
TASK 4: Exploratory Data Analysis
Running EDA for yellow taxi trip data...
Loading cleaned yellow taxi data...
Initializing Dask-SQL context...
Running Dask-SQL: trips per year...
Initializing DuckDB and running SQL queries...
DuckDB: trips per pickup location ID...
DuckDB: trips per hour of day...
DuckDB: median fare per year...
DuckDB: median tip amount...
DuckDB: median trip duration (seconds)...
DuckDB: median fare amount overall...
Computing tip vs no-tip percentages (Dask)...
Dask: computing trips per pickup borough...
Dask: computing OD matrix (boroughs)...
Extracting top 10 OD borough pairs...
Dask: computing OD matrix (PULocationID, DOLocationID)...
Extracting top 10 OD ID pairs...
Saving all aggregate results to JSON...
All aggregate results saved to results/yellow_tripdata_aggregates.json. Done.
Running EDA for green taxi trip data...
Loading cleaned green taxi data...
Initializing Dask-SQL context...
Running Dask-SQL: trips per year...
Initializing DuckDB and running SQL queries...
DuckDB: trips per pickup location ID...
DuckDB: trips per hour of day...
DuckDB: median fare per year...
DuckDB: median tip amount...
DuckDB: median trip duration (seconds)...
DuckDB: median fare amount overall...
Computing tip vs no-tip percentages (Dask)...
Dask: computing trips per pickup borough...
Dask: computing OD matrix (boroughs)...
Extracting top 10 OD borough pairs...
Dask: computing OD matrix (PULocationID, DOLocationID)...
Extracting top 10 OD ID pairs...
Saving all aggregate results to JSON...
All aggregate results saved to results/green_tripdata_aggregates.json. Done.
Running EDA for fhv trip data...
Loading cleaned fhv data...
Initializing Dask-SQL context...
Running Dask-SQL: trips per year...
Initializing DuckDB and running SQL queries...
DuckDB: trips per pickup location ID...
DuckDB: trips per hour of day...
DuckDB: trip duration stats using datetime diff...
Dask: computing trips per pickup borough...
Dask: computing OD matrix (boroughs)...
Extracting top 10 OD borough pairs...
Dask: computing OD matrix (PULocationID, DOLocationID)...
Extracting top 10 OD ID pairs...
Saving all aggregate results to JSON...
All aggregate results saved to results/fhv_tripdata_aggregates.json.
Running EDA for fhvhv trip data...
Loading cleaned fhvhv data...
Initializing Dask-SQL context...
Running Dask-SQL: trips per year...
Initializing DuckDB and running SQL queries...
DuckDB: trips per pickup location ID...
DuckDB: trips per hour of day...
DuckDB: median tip amount...
DuckDB: median trip duration (seconds)...
DuckDB: median base_passenger_fare...
Computing tip vs no-tip percentages (Dask)...
Dask: computing trips per pickup borough...
Dask: computing OD matrix (boroughs)...
Extracting top 10 OD borough pairs...
Dask: computing OD matrix (PULocationID, DOLocationID)...
Extracting top 10 OD ID pairs...
Saving all aggregate results to JSON...
All aggregate results saved to results/fhvhv_tripdata_aggregates.json.
Pipeline completed successfully.
